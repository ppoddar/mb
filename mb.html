<!DOCTYPE html5>
<html>
    <head>
        <meta charset="utf-8">
        <script src="./script/mb.js"></script>
        <link rel="icon" type="image/x-icon" href="../images/ganesha.ico">
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8/jquery.min.js"></script>
<script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8/jquery-ui.min.js"></script>
<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
<link rel="stylesheet" href=" http://ajax.googleapis.com/ajax/libs/jqueryui/1.10.3/themes/blizer/jquery-ui.css">
<link rel="stylesheet" href="./css/mb.css">

    
    <script>
    $(function(){
            
            var mb = new Mahabharatha({root:'content'})
            show_repository(mb.repo, $('#toc'))
            show_chapter(mb.repo.find_chapter(localStorage.getItem('parva.index')||0, localStorage.getItem('chapter.index')||0))
        
        
        
           function show_repository(repo, $ul){
                for(var i = 0; i<repo.parvas.length; i++){
                    var $li = $('<li>')
                    var  p  = repo.parvas[i]
                        $li.text(p.label + ' ' + p.title)
                    show_parva(p, $li)
                    $ul.append($li)
                }
           }

           function show_parva (parva){
            for (var i=0; i<parva.chapters.length;i++){
                var ch = parva.chapters[i]
                show_chapter(ch)
            }
           }

           function show_chapter(chapter) {
            console.log('showing chapter title=' + chapter.title + 'url=' + chapter.url + 'parva url=' + chapter.parva.url)
            localStorage.setItem('parva-index', chapter.parva.index)
            localStorage.setItem('chapter-index', chapter.index)
            $('#chapter > #title').text(chapter.label+' '+chapter.title)
            $('#chapter > #content').load(chapter.url, function(){
                var next_chapter=mb.repo.next_chapter(chapter)
                $('#next-chapter').on('click', show_chapter.bind(mb, next_chapter))
                return  false
            })}
        })
        
          

        </script>
    </head>
        <ul id="toc"></ul>
        <div id="chapter">
            <div id="title"></div>
            <div id="content">
            </div>
            <div class="w3-bar">
                <div class="w3-bar-item w3-button" id="next-chapter">read more...</div>
                <span class="w3-bar-item w3-right" id="copyright">&copy;Pinaki Poddar 2024-30</span>
            </div>
        </div>
            </div>
    
</html>